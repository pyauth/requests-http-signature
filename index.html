
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>requests-http-signature: A Requests auth module for HTTP Signature &#8212; requests-http-signature  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/guzzle.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">requests-http-signature  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">requests-http-signature: A Requests auth module for HTTP Signature</a></li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar"><a href="
    #" class="text-logo">requests-http-signature</a>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Contents</h2>
    <div class="sidebar-localtoc">
      <ul>
<li><a class="reference internal" href="#">requests-http-signature: A Requests auth module for HTTP Signature</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#verifying-responses">Verifying responses</a></li>
<li><a class="reference internal" href="#asymmetric-key-algorithms">Asymmetric key algorithms</a></li>
<li><a class="reference internal" href="#digest-algorithms">Digest algorithms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#links">Links</a><ul>
<li><a class="reference internal" href="#bugs">Bugs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#license">License</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id3">API documentation</a></li>
</ul>

    </div>
  </div>
</div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="#">Docs</a></li>
              
              <li>requests-http-signature: A Requests auth module for HTTP Signature</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <section id="requests-http-signature-a-requests-auth-module-for-http-signature">
<h1>requests-http-signature: A Requests auth module for HTTP Signature<a class="headerlink" href="#requests-http-signature-a-requests-auth-module-for-http-signature" title="Permalink to this headline">¶</a></h1>
<p><strong>requests-http-signature</strong> is a <a class="reference external" href="https://github.com/requests/requests">Requests</a> <a class="reference external" href="http://docs.python-requests.org/en/master/user/authentication/">authentication plugin</a> (<code class="docutils literal notranslate"><span class="pre">requests.auth.AuthBase</span></code> subclass) implementing
the <a class="reference external" href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-message-signatures/">IETF HTTP Message Signatures draft standard</a>.</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install requests-http-signature
</pre></div>
</div>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">requests_http_signature</span> <span class="kn">import</span> <span class="n">HTTPSignatureAuth</span><span class="p">,</span> <span class="n">algorithms</span>

<span class="n">preshared_key_id</span> <span class="o">=</span> <span class="s1">&#39;squirrel&#39;</span>
<span class="n">preshared_secret</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;monorail_cat&#39;</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://example.com/&#39;</span>

<span class="n">auth</span> <span class="o">=</span> <span class="n">HTTPSignatureAuth</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">preshared_secret</span><span class="p">,</span>
                         <span class="n">key_id</span><span class="o">=</span><span class="n">preshared_key_id</span><span class="p">,</span>
                         <span class="n">signature_algorithm</span><span class="o">=</span><span class="n">algorithms</span><span class="o">.</span><span class="n">HMAC_SHA256</span><span class="p">)</span>
<span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, only the <code class="docutils literal notranslate"><span class="pre">Date</span></code> header and the <code class="docutils literal notranslate"><span class="pre">&#64;method</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;authority</span></code>, and <code class="docutils literal notranslate"><span class="pre">&#64;target-uri</span></code> derived component
identifiers are signed for body-less requests such as GET. The <code class="docutils literal notranslate"><span class="pre">Date</span></code> header is set if it is absent. In addition,
the <code class="docutils literal notranslate"><span class="pre">Authorization</span></code> header is signed if it is present, and for requests with bodies (such as POST), the
<code class="docutils literal notranslate"><span class="pre">Content-Digest</span></code> header is set to the SHA256 of the request body using the format described in the
<a class="reference external" href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-digest-headers">IETF Digest Fields draft</a> and signed.
To add other headers to the signature, pass an array of header names in the <code class="docutils literal notranslate"><span class="pre">covered_component_ids</span></code> keyword argument.
See the <a class="reference external" href="https://pyauth.github.io/requests-http-signature/#id3">API documentation</a> for the full list of options and
details.</p>
<section id="verifying-responses">
<h3>Verifying responses<a class="headerlink" href="#verifying-responses" title="Permalink to this headline">¶</a></h3>
<p>The class method <code class="docutils literal notranslate"><span class="pre">HTTPSignatureAuth.verify()</span></code> can be used to verify responses received back from the server:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyKeyResolver</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">resolve_public_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_id</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">key_id</span> <span class="o">==</span> <span class="s1">&#39;squirrel&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;monorail_cat&#39;</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">)</span>
<span class="n">verify_result</span> <span class="o">=</span> <span class="n">HTTPSignatureAuth</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                         <span class="n">signature_algorithm</span><span class="o">=</span><span class="n">algorithms</span><span class="o">.</span><span class="n">HMAC_SHA256</span><span class="p">,</span>
                                         <span class="n">key_resolver</span><span class="o">=</span><span class="n">MyKeyResolver</span><span class="p">())</span>
</pre></div>
</div>
<p>More generally, you can reconstruct an arbitrary request using the
<a class="reference external" href="https://docs.python-requests.org/en/latest/api/#requests.Request">Requests API</a> and pass it to <code class="docutils literal notranslate"><span class="pre">verify()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">request</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># Reconstruct the incoming request using the Requests API</span>
<span class="n">prepared_request</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>  <span class="c1"># Generate a PreparedRequest</span>
<span class="n">HTTPSignatureAuth</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">prepared_request</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>To verify incoming requests and sign responses in the context of an HTTP server, see the
<a class="reference external" href="https://github.com/pyauth/flask-http-signature">flask-http-signature</a> and
<a class="reference external" href="https://github.com/pyauth/http-message-signatures">http-message-signatures</a> packages.</p>
<div class="admonition-see-what-is-signed admonition">
<p class="admonition-title">See what is signed</p>
<p>It is important to understand and follow the best practice rule of “See what is signed” when verifying HTTP message
signatures. The gist of this rule is: if your application neglects to verify that the information it trusts is
what was actually signed, the attacker can supply a valid signature but point you to malicious data that wasn’t signed
by that signature. Failure to follow this rule can lead to vulnerability against signature wrapping and substitution
attacks.</p>
<p>In requests-http-signature, you can ensure that the information signed is what you expect to be signed by only trusting
the data returned by the <code class="docutils literal notranslate"><span class="pre">verify()</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">verify_result</span> <span class="o">=</span> <span class="n">HTTPSignatureAuth</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>See the <a class="reference external" href="https://pyauth.github.io/requests-http-signature/#id3">API documentation</a> for full details.</p>
</section>
<section id="asymmetric-key-algorithms">
<h3>Asymmetric key algorithms<a class="headerlink" href="#asymmetric-key-algorithms" title="Permalink to this headline">¶</a></h3>
<p>To sign or verify messages with an asymmetric key algorithm, set the <code class="docutils literal notranslate"><span class="pre">signature_algorithm</span></code> keyword argument to
<code class="docutils literal notranslate"><span class="pre">algorithms.ED25519</span></code>, <code class="docutils literal notranslate"><span class="pre">algorithms.ECDSA_P256_SHA256</span></code>, <code class="docutils literal notranslate"><span class="pre">algorithms.RSA_V1_5_SHA256</span></code>, or
<code class="docutils literal notranslate"><span class="pre">algorithms.RSA_PSS_SHA512</span></code>.</p>
<p>For asymmetric key algorithms, you can supply the private key as the <code class="docutils literal notranslate"><span class="pre">key</span></code> parameter to the <code class="docutils literal notranslate"><span class="pre">HTTPSignatureAuth()</span></code>
constructor as bytes in the PEM format, or configure the key resolver as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;key.pem&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
    <span class="n">auth</span> <span class="o">=</span> <span class="n">HTTPSignatureAuth</span><span class="p">(</span><span class="n">signature_algorithm</span><span class="o">=</span><span class="n">algorithms</span><span class="o">.</span><span class="n">RSA_V1_5_SHA256</span><span class="p">,</span>
                             <span class="n">key</span><span class="o">=</span><span class="n">fh</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
                             <span class="n">key_id</span><span class="o">=</span><span class="n">preshared_key_id</span><span class="p">)</span>
<span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">MyKeyResolver</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">resolve_public_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">public_key_pem_bytes</span><span class="p">[</span><span class="n">key_id</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">resolve_private_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">private_key_pem_bytes</span><span class="p">[</span><span class="n">key_id</span><span class="p">]</span>

<span class="n">auth</span> <span class="o">=</span> <span class="n">HTTPSignatureAuth</span><span class="p">(</span><span class="n">signature_algorithm</span><span class="o">=</span><span class="n">algorithms</span><span class="o">.</span><span class="n">RSA_V1_5_SHA256</span><span class="p">,</span>
                         <span class="n">key</span><span class="o">=</span><span class="n">fh</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
                         <span class="n">key_resolver</span><span class="o">=</span><span class="n">MyKeyResolver</span><span class="p">())</span>
<span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="digest-algorithms">
<h3>Digest algorithms<a class="headerlink" href="#digest-algorithms" title="Permalink to this headline">¶</a></h3>
<p>To generate a Content-Digest header using SHA-512 instead of the default SHA-256, subclass <code class="docutils literal notranslate"><span class="pre">HTTPSignatureAuth</span></code> as
follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MySigner</span><span class="p">(</span><span class="n">HTTPSignatureAuth</span><span class="p">):</span>
    <span class="n">signing_content_digest_algorithm</span> <span class="o">=</span> <span class="s2">&quot;sha-512&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="links">
<h2>Links<a class="headerlink" href="#links" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pyauth/requests-http-signature">Project home page (GitHub)</a></p></li>
<li><p><a class="reference external" href="https://pyauth.github.io/requests-http-signature/">Package documentation</a></p></li>
<li><p><a class="reference external" href="https://pypi.python.org/pypi/requests-http-signature">Package distribution (PyPI)</a></p></li>
<li><p><a class="reference external" href="https://github.com/pyauth/requests-http-signature/blob/master/Changes.rst">Change log</a></p></li>
<li><p><a class="reference external" href="https://github.com/pyauth/http-message-signatures">http-message-signatures</a> - a dependency of this library that
handles much of the implementation</p></li>
<li><p><a class="reference external" href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-message-signatures">IETF HTTP Signatures draft</a></p></li>
</ul>
<section id="bugs">
<h3>Bugs<a class="headerlink" href="#bugs" title="Permalink to this headline">¶</a></h3>
<p>Please report bugs, issues, feature requests, etc. on <a class="reference external" href="https://github.com/pyauth/requests-http-signature/issues">GitHub</a>.</p>
</section>
</section>
<section id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
<p>Licensed under the terms of the <a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.</p>
</section>
</section>
<section id="id3">
<h1>API documentation<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-requests_http_signature"></span><dl class="py class">
<dt class="sig sig-object py" id="requests_http_signature.HTTPSignatureAuth">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">requests_http_signature.</span></span><span class="sig-name descname"><span class="pre">HTTPSignatureAuth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signature_algorithm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_resolver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covered_component_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('&#64;method',</span> <span class="pre">'&#64;authority',</span> <span class="pre">'&#64;target-uri')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_alg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_nonce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expires_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/requests_http_signature.html#HTTPSignatureAuth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#requests_http_signature.HTTPSignatureAuth" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://github.com/requests/requests">Requests</a> <a class="reference external" href="http://docs.python-requests.org/en/master/user/authentication/">authentication plugin</a> (<code class="docutils literal notranslate"><span class="pre">requests.auth.AuthBase</span></code> subclass)
implementing the <a class="reference external" href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-message-signatures/">IETF HTTP Message Signatures draft RFC</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signature_algorithm</strong> (<em>Type</em><em>[</em><em>http_message_signatures._algorithms.HTTPSignatureAlgorithm</em><em>]</em>) – One of <code class="docutils literal notranslate"><span class="pre">requests_http_signature.algorithms.HMAC_SHA256</span></code>,
<code class="docutils literal notranslate"><span class="pre">requests_http_signature.algorithms.ECDSA_P256_SHA256</span></code>,
<code class="docutils literal notranslate"><span class="pre">requests_http_signature.algorithms.ED25519</span></code>,
<code class="docutils literal notranslate"><span class="pre">requests_http_signature.algorithms.RSA_PSS_SHA512</span></code>, or
<code class="docutils literal notranslate"><span class="pre">requests_http_signature.algorithms.RSA_V1_5_SHA256</span></code>.</p></li>
<li><p><strong>key</strong> (<em>bytes</em>) – Key material that will be used to sign the request. In the case of HMAC, this should be the raw bytes of the
shared secret; for all other algorithms, this should be the bytes of the PEM-encoded private key material.</p></li>
<li><p><strong>key_id</strong> (<em>str</em>) – The key ID to use in the signature.</p></li>
<li><p><strong>key_resolver</strong> (<em>http_message_signatures.resolvers.HTTPSignatureKeyResolver</em>) – Instead of specifying a fixed key, you can instead pass a key resolver, which should be an instance of a
subclass of <code class="docutils literal notranslate"><span class="pre">http_message_signatures.HTTPSignatureKeyResolver</span></code>. A key resolver should have two methods,
<code class="docutils literal notranslate"><span class="pre">get_private_key(key_id)</span></code> (required only for signing) and <code class="docutils literal notranslate"><span class="pre">get_public_key(key_id)</span></code> (required only for
verifying). Your implementation should ensure that the key id is recognized and return the corresponding
key material as PEM bytes (or shared secret bytes for HMAC).</p></li>
<li><p><strong>covered_component_ids</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – A list of lowercased header names or derived component IDs (<code class="docutils literal notranslate"><span class="pre">&#64;method</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;target-uri</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;authority</span></code>,
<code class="docutils literal notranslate"><span class="pre">&#64;scheme</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;request-target</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;path</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;query</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;query-params</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;status</span></code>, or
<code class="docutils literal notranslate"><span class="pre">&#64;request-response</span></code>, as specified in the standard) to sign. By default, <code class="docutils literal notranslate"><span class="pre">&#64;method</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;authority</span></code>,
and <code class="docutils literal notranslate"><span class="pre">&#64;target-uri</span></code> are covered, and the <code class="docutils literal notranslate"><span class="pre">Authorization</span></code>, <code class="docutils literal notranslate"><span class="pre">Content-Digest</span></code>, and <code class="docutils literal notranslate"><span class="pre">Date</span></code> header fields
are always covered if present.</p></li>
<li><p><strong>label</strong> (<em>str</em>) – The label to use to identify the signature.</p></li>
<li><p><strong>include_alg</strong> (<em>bool</em>) – By default, the signature parameters will include the <code class="docutils literal notranslate"><span class="pre">alg</span></code> parameter, using it to identify the signature
algorithm. If you wish not to include this parameter, set this to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>use_nonce</strong> (<em>bool</em>) – Set this to <code class="docutils literal notranslate"><span class="pre">True</span></code> to include a unique message-specific nonce in the signature parameters. The format of
the nonce can be controlled by subclassing this class and overloading the <code class="docutils literal notranslate"><span class="pre">get_nonce()</span></code> method.</p></li>
<li><p><strong>expires_in</strong> (<em>datetime.timedelta</em>) – Use this to set the <code class="docutils literal notranslate"><span class="pre">expires</span></code> signature parameter to the time of signing plus the given timedelta.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="requests_http_signature.HTTPSignatureAuth.component_resolver_class">
<span class="sig-name descname"><span class="pre">component_resolver_class</span></span><a class="headerlink" href="#requests_http_signature.HTTPSignatureAuth.component_resolver_class" title="Permalink to this definition">¶</a></dt>
<dd><p>A subclass of <code class="docutils literal notranslate"><span class="pre">http_message_signatures.HTTPSignatureComponentResolver</span></code> can be used to override this value
to customize the retrieval of header and derived component values if needed.</p>
<p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">http_message_signatures.resolvers.HTTPSignatureComponentResolver</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="requests_http_signature.HTTPSignatureAuth.signing_content_digest_algorithm">
<span class="sig-name descname"><span class="pre">signing_content_digest_algorithm</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sha-256'</span></em><a class="headerlink" href="#requests_http_signature.HTTPSignatureAuth.signing_content_digest_algorithm" title="Permalink to this definition">¶</a></dt>
<dd><p>The hash algorithm to use to generate the Content-Digest header field (either <code class="docutils literal notranslate"><span class="pre">sha-256</span></code> or <code class="docutils literal notranslate"><span class="pre">sha-512</span></code>).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="requests_http_signature.HTTPSignatureAuth.verify">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">verify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">require_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('&#64;method',</span> <span class="pre">'&#64;authority',</span> <span class="pre">'&#64;target-uri')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signature_algorithm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_resolver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_age</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">datetime.timedelta(days=1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/requests_http_signature.html#HTTPSignatureAuth.verify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#requests_http_signature.HTTPSignatureAuth.verify" title="Permalink to this definition">¶</a></dt>
<dd><p>Verify an HTTP message signature.</p>
<div class="admonition-see-what-is-signed admonition">
<p class="admonition-title">See what is signed</p>
<p>It is important to understand and follow the best practice rule of “See what is signed” when verifying HTTP
message signatures. The gist of this rule is: if your application neglects to verify that the information it
trusts is what was actually signed, the attacker can supply a valid signature but point you to malicious data
that wasn’t signed by that signature. Failure to follow this rule can lead to vulnerability against signature
wrapping and substitution attacks.</p>
<p>You can ensure that the information signed is what you expect to be signed by only trusting the <em>VerifyResult</em>
tuple returned by <code class="docutils literal notranslate"><span class="pre">verify()</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<em>Union</em><em>[</em><em>requests.models.PreparedRequest</em><em>, </em><em>requests.models.Response</em><em>]</em>) – <p>The HTTP response or request to verify. You can either pass a received response, or reconstruct an arbitrary
request using the <a class="reference external" href="https://docs.python-requests.org/en/latest/api/#requests.Request">Requests API</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">request</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">prepared_request</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>
<span class="n">HTTPSignatureAuth</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">prepared_request</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
</p></li>
<li><p><strong>require_components</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – <p>A list of lowercased header names or derived component IDs (<code class="docutils literal notranslate"><span class="pre">&#64;method</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;target-uri</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;authority</span></code>,
<code class="docutils literal notranslate"><span class="pre">&#64;scheme</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;request-target</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;path</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;query</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;query-params</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;status</span></code>, or
<code class="docutils literal notranslate"><span class="pre">&#64;request-response</span></code>, as specified in the standard) to require to be covered by the signature. If the
<code class="docutils literal notranslate"><span class="pre">content-digest</span></code> header field is specified here (recommended for messages that have a body), it will be
verified by matching it against the digest hash computed on the body of the message (expected to be bytes).</p>
<p>If this parameter is not specified, <code class="docutils literal notranslate"><span class="pre">verify()</span></code> will set it to <code class="docutils literal notranslate"><span class="pre">(&quot;&#64;method&quot;,</span> <span class="pre">&quot;&#64;authority&quot;,</span> <span class="pre">&quot;&#64;target-uri&quot;)</span></code>
for messages without a body, and <code class="docutils literal notranslate"><span class="pre">(&quot;&#64;method&quot;,</span> <span class="pre">&quot;&#64;authority&quot;,</span> <span class="pre">&quot;&#64;target-uri&quot;,</span> <span class="pre">&quot;content-digest&quot;)</span></code> for messages
with a body.</p>
</p></li>
<li><p><strong>signature_algorithm</strong> (<em>Type</em><em>[</em><em>http_message_signatures._algorithms.HTTPSignatureAlgorithm</em><em>]</em>) – The algorithm expected to be used by the signature. Any signature not using the expected algorithm will
cause an <code class="docutils literal notranslate"><span class="pre">InvalidSignature</span></code> exception. Must be one of <code class="docutils literal notranslate"><span class="pre">requests_http_signature.algorithms.HMAC_SHA256</span></code>,
<code class="docutils literal notranslate"><span class="pre">requests_http_signature.algorithms.ECDSA_P256_SHA256</span></code>,
<code class="docutils literal notranslate"><span class="pre">requests_http_signature.algorithms.ED25519</span></code>,
<code class="docutils literal notranslate"><span class="pre">requests_http_signature.algorithms.RSA_PSS_SHA512</span></code>, or
<code class="docutils literal notranslate"><span class="pre">requests_http_signature.algorithms.RSA_V1_5_SHA256</span></code>.</p></li>
<li><p><strong>key_resolver</strong> (<em>http_message_signatures.resolvers.HTTPSignatureKeyResolver</em>) – A key resolver, which should be an instance of a subclass of
<code class="docutils literal notranslate"><span class="pre">http_message_signatures.HTTPSignatureKeyResolver</span></code>. A key resolver should have two methods,
<code class="docutils literal notranslate"><span class="pre">get_private_key(key_id)</span></code> (required only for signing) and <code class="docutils literal notranslate"><span class="pre">get_public_key(key_id)</span></code> (required only for
verifying). Your implementation should ensure that the key id is recognized and return the corresponding
key material as PEM bytes (or shared secret bytes for HMAC).</p></li>
<li><p><strong>max_age</strong> (<em>datetime.timedelta</em>) – The maximum age of the signature, defined as the difference between the <code class="docutils literal notranslate"><span class="pre">created</span></code> parameter value and now.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><em>VerifyResult</em>, a namedtuple with the following attributes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">label</span></code> (str): The label for the signature</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code>: (same as <code class="docutils literal notranslate"><span class="pre">signature_algorithm</span></code> above)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">covered_components</span></code>: A mapping of component names to their values, as covered by the signature</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parameters</span></code>: A mapping of signature parameters to their values, as covered by the signature, including
“alg”, “created”, “expires”, “keyid”, and “nonce”. To protect against replay attacks, retrieve the “nonce”
parameter here and check that it has not been seen before.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code>: The message body for messages that have a body and pass validation of the covered
content-digest; <code class="docutils literal notranslate"><span class="pre">None</span></code> otherwise.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">InvalidSignature</span></code> - raised whenever signature validation fails for any reason.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>http_message_signatures.structures.VerifyResult</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="requests_http_signature.RequestsHttpSignatureException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">requests_http_signature.</span></span><span class="sig-name descname"><span class="pre">RequestsHttpSignatureException</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/requests_http_signature.html#RequestsHttpSignatureException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#requests_http_signature.RequestsHttpSignatureException" title="Permalink to this definition">¶</a></dt>
<dd><p>An error occurred while constructing the HTTP Signature for your request.</p>
</dd></dl>

<div class="toctree-wrapper compound">
</div>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


          </div>
            
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">requests-http-signature  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">requests-http-signature: A Requests auth module for HTTP Signature</a></li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright Andrey Kislyuk. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>